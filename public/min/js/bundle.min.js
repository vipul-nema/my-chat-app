var User=function(){function e(e,t){switch(e){case"event-get-users":this.socket.on("event-get-users",t);break;case"event-get-msg":this.socket.on("event-get-msg",t);break;case"event-update-chat-history":this.socket.on("event-update-chat-history",t)}}function t(){this.socket.emit("event-add-user",{name:this.name,mobile:this.mobile})}function a(e,t){this.socket.emit("event-search-friend",{mobile:e},t)}function n(e){this.socket.emit("event-get-chat-history",{to:e.mobile,from:this.mobile})}function s(e,t){this.socket.emit("event-send-msg",{to:e.mobile,message:t,from:this.mobile})}return function(i,r){this.name=i,this.mobile=r,this.sendMessage=s,this.getChatHistory=n,this.socket=io.connect(),this.addUser=t,this.bindEvent=e,this.searchFriend=a}}();!function(){var e=React.createClass({displayName:"FriendChatBox",getInitialState:function(){return{message:"",friendChat:this.props.friendChat}},componentWillMount:function(){this.props.user.bindEvent("event-get-msg",this.recieveMessage)},componentWillReceiveProps:function(e){this.setState({friendChat:e.friendChat})},createMessage:function(e){this.setState({message:e.target.value})},sendMessage:function(e){e.stopPropagation(),e.preventDefault(),this.props.user.sendMessage(this.props.friend,this.state.message);var t=document.querySelectorAll(".chat-box-container ul")[0];t.scrollTop=t.scrollHeight+200,this.setState({message:""})},recieveMessage:function(e){this.state.friendChat.push(e),this.setState({friendChat:this.state.friendChat})},render:function(){var e=this;return React.createElement("div",{className:"col-sm-12 col-lg-12 border-top-0 chat-box-container  "},React.createElement("ul",null,this.state.friendChat.map(function(t,a){return React.createElement("li",null,React.createElement("div",null,t.from==e.props.myMobile&&React.createElement("p",{className:"text-right"}," ",t.message," - ME "),t.from!=e.props.myMobile&&React.createElement("p",{className:"text-left"}," ",e.props.friend.name," - ",t.message)))}),this.state.friendChat&&this.state.friendChat.length<=0&&React.createElement("li",null,"No chat history yet ")),React.createElement("form",{className:"chat-box",onSubmit:this.sendMessage},React.createElement("input",{className:"form-control",type:"text",placeholder:"Enter message",value:this.state.message,onChange:this.createMessage})))}}),t=React.createClass({displayName:"FriendList",getInitialState:function(){return{friend:void 0,friendList:{},friendChat:[]}},componentWillMount:function(){this.props.user.bindEvent("event-get-users",this.getFriends),this.props.user.bindEvent("event-update-chat-history",this.updateChatHistory)},componentDidMount:function(){this.props.user.addUser()},updateChatHistory:function(e){this.setState({friendChat:e||[]})},getFriends:function(e){this.setState({friendList:e})},filterFiend:function(e){},getChatHistory:function(e){var t=this;this.setState({friend:e,friendChat:[]},function(){t.props.user.getChatHistory(e)})},addNewFriend:function(e){var t=document.getElementsByClassName("add-new-friend")[0];t.value&&this.props.user.searchFriend(t.value,function(e){alert(e)})},render:function(){var t=this,a=t.state.friendList;return React.createElement("div",{className:"row friend-list-container"},React.createElement("div",{className:"row col-sm-12 col-lg-5"},React.createElement("div",{className:" col-sm-12 col-lg-12 text-center "},React.createElement("label",null,React.createElement("strong",null,"Your Name : ",this.props.name)," "),React.createElement("br",null),React.createElement("label",null,React.createElement("strong",null,"Your Mobile : ",this.props.mobile)," "),React.createElement("hr",null),"Friend List",React.createElement("input",{className:"form-control add-new-friend",type:"text",placeholder:"search for friend with mobile number"}),React.createElement("button",{className:"btn btn-primary",onClick:this.addNewFriend},"Add New Friend")),React.createElement("div",{className:" row col-sm-12 col-lg-12"},React.createElement("ul",{className:" friend-list row col-sm-12 col-lg-12 border border-primary"},Object.keys(a).map(function(e,n){var s=a[e].online?" online ":" ";return s+="btn rounded-circle ",React.createElement("li",{className:"row col-sm-12 col-lg-12 friend-detail rounded",key:e},React.createElement("div",{className:"col-sm-8 col-lg-8"},React.createElement("p",null,"Name : ",a[e].name," "),React.createElement("p",null,"Mobile: ",a[e].mobile)),React.createElement("div",{className:"col-sm-2 col-lg-2"},React.createElement("button",{className:s,onClick:t.getChatHistory.bind(t,a[e])},"Chat")))})))),this.state.friend&&React.createElement("div",{className:"row col-sm-12 col-lg-7"},React.createElement(e,{user:this.props.user,friend:this.state.friend,friendChat:this.state.friendChat,myMobile:this.props.mobile,myName:this.props.name})))}}),a=React.createClass({displayName:"JoinChatComp",getInitialState:function(){return{}},getChatHistory:function(e,t){this.user.getChatHistory(e,t,this.props.mobile)},componentWillMount:function(){this.user=new User(this.props.name,this.props.mobile)},render:function(){return React.createElement("div",null,React.createElement(t,{user:this.user,mobile:this.props.mobile,name:this.props.name}))}}),n=React.createClass({displayName:"LoginComp",getInitialState:function(){return{name:"",mobile:""}},onSubmit:function(e){e.preventDefault(),e.stopPropagation(),this.props.loginApp(this.state)},handleChange:function(e){var t=e.target;this.state[t.name]=t.value,this.setState({state:this.state})},render:function(){return React.createElement("div",{id:"login-comp",className:"row col-sm-12 col-lg-8"},React.createElement("div",{className:" col-sm-12 col-lg-12"}," Welcome to My chat app"),React.createElement("div",{className:"row col-sm-12 col-lg-12"},React.createElement("form",{onSubmit:this.onSubmit},React.createElement("input",{className:"form-control",type:"text",placeholder:"Enter Name",value:this.state.name,onChange:this.handleChange,name:"name"}),React.createElement("input",{className:"form-control",type:"text",placeholder:"Enter Mobile",value:this.state.mobile,onChange:this.handleChange,name:"mobile"}),React.createElement("br",null),React.createElement("input",{className:"btn btn-primary",type:"submit",value:"Login"}))),React.createElement("div",{className:" col-sm-12 col-lg-12"},"you can use any name and some harcoded user mobile number like- 999,888,777,555 for seeing frined list"))}}),s=React.createClass({displayName:"MyChatApp",getInitialState:function(){return{login:!1,name:"",mobile:""}},loginApp:function(e){this.setState({name:e.name,mobile:e.mobile,login:!0})},render:function(){return React.createElement("div",{className:"container-fluid"},React.createElement("div",{className:"row text-center"},this.state.login?React.createElement(a,{name:this.state.name,mobile:this.state.mobile}):React.createElement(n,{loginApp:this.loginApp})))}});ReactDOM.render(React.createElement(s,null),document.getElementById("app"))}();